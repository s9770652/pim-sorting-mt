\section{\texorpdfstring{\HS{}}{HeapSort}}
\label{sec:tasklet:heap}

\HS{}~\cites{floyd1964treesort}{williams1964heapsort}[Chapter~2.2.5]{wirth1975algorithmen} makes use of a so-called \emph{heap}, which is a priority queue allowing to retrieve and remove the maximum element stored in time \(\bigoh{\log n}\).
Repeated retrieval and removal of the maximum allows to sort in place in time \(\bigoh{n \log n}\), although the sorting is not stable.

A heap (or, more specifically, a \emph{binary max-heap}) is a binary tree of logarithmic depth whose layers are fully filled, that is, the layer of depth \(i\) contains \(\twotoi\) vertices.
The only exception is the last layer, which may contain less vertices but must be filled from left to right.
In the context of \HS{}, the vertices are identified with the elements to sort.
The \emph{heap order} dictates that each parent must be at least as great as its child.
Consequently, the root is a greatest element.
A heap with \(n\) vertices can be represented as an array of length \(n\) using a bijective mapping between the vertices and the array indices:
If the root is stored at position \(1\), the children of the vertex with index \(i\) have the indices \(\twoi\) and \(\twoi + 1\), whilst its parent has index \(i \div 2\), where the obelus (\(\div\)) denotes an integer division.

After the heap has been built in place from the input array in time \(\bigoh{n}\), the sorting works as follows:
At the start of round~\(r = 1, \dots, n\), the first \(n - (r - 1)\) elements of the array represent the heap and the last~\(r - 1\) elements the end of the sorted output.
The root, which is the \(r\itordinal\)th greatest element of the input, gets removed and, since the heap cannot contain holes, a reparation procedure is performed.
Since the heap has shrunken by one vertex, the removed root can be stored at index \(n - (r - 1)\), that is the freed-up position directly behind the end of the heap.

\input{tasklet_heap_aspects}

\input{tasklet_heap_compilation}

\input{tasklet_heap_performance}
